
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fairfax County School Safety Scorer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 100%;
            padding: 20px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        .search-container {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        input[type="text"] {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .search-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .search-btn:hover {
            transform: translateY(-2px);
        }

        .filter-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: #f0f0f0;
            border: 1px solid #ddd;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .school-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .school-card:hover {
            transform: translateY(-3px);
        }

        .school-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .school-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
        }

        .school-type {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .safety-score {
            text-align: center;
            min-width: 80px;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: white;
            margin: 0 auto 8px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            border: 4px solid rgba(255,255,255,0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .score-excellent { background: #4caf50; }
        .score-good { background: #8bc34a; }
        .score-fair { background: #ff9800; }
        .score-poor { background: #f44336; }

        .score-label {
            font-size: 0.9rem;
            color: #333;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .metric {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #666;
        }

        .metric-low { color: #4caf50; }
        .metric-medium { color: #ff9800; }
        .metric-high { color: #f44336; }

        .school-address {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .info-box {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            color: white;
        }

        .info-box h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .info-box p {
            font-size: 0.9rem;
            line-height: 1.5;
            opacity: 0.9;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 800px;
            }
            
            .header h1 {
                font-size: 2.5rem;
            }
            
            .search-box {
                flex-direction: row;
            }
            
            .school-card {
                padding: 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè´ School Safety Scorer</h1>
            <p>Find the safest elementary and middle schools in Fairfax County</p>
        </div>

        <div class="info-box">
            <h3>üìä How We Calculate Safety Scores</h3>
            <p>Our safety score combines crime rates, traffic incidents, registered sex offender proximity, and other public safety data within a 0.5-mile radius of each school. Scores range from 0-100, with higher scores indicating safer environments.</p>
        </div>

        <div class="search-container">
            <div class="search-box">
                <select id="schoolSelect" style="flex: 1; padding: 15px; border: 2px solid #e0e0e0; border-radius: 12px; font-size: 16px; background: white; cursor: pointer;">
                    <option value="">Select a school...</option>
                    <optgroup label="Elementary Schools">
                        <option value="Annandale Elementary School">Annandale Elementary School</option>
                        <option value="Bailey's Elementary School">Bailey's Elementary School</option>
                        <option value="Belvedere Elementary School">Belvedere Elementary School</option>
                        <option value="Braddock Elementary School">Braddock Elementary School</option>
                        <option value="Brookfield Elementary School">Brookfield Elementary School</option>
                        <option value="Burke Elementary School">Burke Elementary School</option>
                        <option value="Burgundy Village Elementary School">Burgundy Village Elementary School</option>
                        <option value="Camelot Elementary School">Camelot Elementary School</option>
                        <option value="Cameron Elementary School">Cameron Elementary School</option>
                        <option value="Canterbury Woods Elementary School">Canterbury Woods Elementary School</option>
                        <option value="Centreville Elementary School">Centreville Elementary School</option>
                        <option value="Chantilly Elementary School">Chantilly Elementary School</option>
                        <option value="Cherry Run Elementary School">Cherry Run Elementary School</option>
                        <option value="Clifton Elementary School">Clifton Elementary School</option>
                        <option value="Colvin Run Elementary School">Colvin Run Elementary School</option>
                        <option value="Coates Elementary School">Coates Elementary School</option>
                        <option value="Countryside Elementary School">Countryside Elementary School</option>
                        <option value="Crossfield Elementary School">Crossfield Elementary School</option>
                        <option value="Daniels Run Elementary School">Daniels Run Elementary School</option>
                        <option value="Davis Elementary School">Davis Elementary School</option>
                        <option value="Dranesville Elementary School">Dranesville Elementary School</option>
                        <option value="Dunn Loring Elementary School">Dunn Loring Elementary School</option>
                        <option value="Eagle View Elementary School">Eagle View Elementary School</option>
                        <option value="Fairfax Villa Elementary School">Fairfax Villa Elementary School</option>
                        <option value="Fairhill Elementary School">Fairhill Elementary School</option>
                        <option value="Fairview Elementary School">Fairview Elementary School</option>
                        <option value="Falls Church Elementary School">Falls Church Elementary School</option>
                        <option value="Flint Hill Elementary School">Flint Hill Elementary School</option>
                        <option value="Forest Edge Elementary School">Forest Edge Elementary School</option>
                        <option value="Fox Mill Elementary School">Fox Mill Elementary School</option>
                        <option value="Franklin Sherman Elementary School">Franklin Sherman Elementary School</option>
                        <option value="Franconia Elementary School">Franconia Elementary School</option>
                        <option value="Freedom Hill Elementary School">Freedom Hill Elementary School</option>
                        <option value="Graham Road Elementary School">Graham Road Elementary School</option>
                        <option value="Great Falls Elementary School">Great Falls Elementary School</option>
                        <option value="Greenbriar West Elementary School">Greenbriar West Elementary School</option>
                        <option value="Greenbriar East Elementary School">Greenbriar East Elementary School</option>
                        <option value="Haycock Elementary School">Haycock Elementary School</option>
                        <option value="Herndon Elementary School">Herndon Elementary School</option>
                        <option value="Highland Elementary School">Highland Elementary School</option>
                        <option value="Hollin Meadows Elementary School">Hollin Meadows Elementary School</option>
                        <option value="Hunt Valley Elementary School">Hunt Valley Elementary School</option>
                        <option value="Hutchison Elementary School">Hutchison Elementary School</option>
                        <option value="Island Creek Elementary School">Island Creek Elementary School</option>
                        <option value="Keene Mill Elementary School">Keene Mill Elementary School</option>
                        <option value="Kings Glen Elementary School">Kings Glen Elementary School</option>
                        <option value="Kings Park Elementary School">Kings Park Elementary School</option>
                        <option value="Lake Anne Elementary School">Lake Anne Elementary School</option>
                        <option value="Laurel Hill Elementary School">Laurel Hill Elementary School</option>
                        <option value="Laurel Ridge Elementary School">Laurel Ridge Elementary School</option>
                        <option value="Lees Corner Elementary School">Lees Corner Elementary School</option>
                        <option value="Liberty Elementary School">Liberty Elementary School</option>
                        <option value="Little Run Elementary School">Little Run Elementary School</option>
                        <option value="Longfellow Middle School Elementary Program">Longfellow Elementary Program</option>
                        <option value="Lorton Station Elementary School">Lorton Station Elementary School</option>
                        <option value="Louise Archer Elementary School">Louise Archer Elementary School</option>
                        <option value="Lynbrook Elementary School">Lynbrook Elementary School</option>
                        <option value="Mason Crest Elementary School">Mason Crest Elementary School</option>
                        <option value="McNair Elementary School">McNair Elementary School</option>
                        <option value="Mosby Woods Elementary School">Mosby Woods Elementary School</option>
                        <option value="Mount Daniel Elementary School">Mount Daniel Elementary School</option>
                        <option value="Mount Vernon Woods Elementary School">Mount Vernon Woods Elementary School</option>
                        <option value="Navy Elementary School">Navy Elementary School</option>
                        <option value="Newington Forest Elementary School">Newington Forest Elementary School</option>
                        <option value="North Springfield Elementary School">North Springfield Elementary School</option>
                        <option value="Nottoway Elementary School">Nottoway Elementary School</option>
                        <option value="Oakton Elementary School">Oakton Elementary School</option>
                        <option value="Oak Hill Elementary School">Oak Hill Elementary School</option>
                        <option value="Oak View Elementary School">Oak View Elementary School</option>
                        <option value="Olde Creek Elementary School">Olde Creek Elementary School</option>
                        <option value="Orange Hunt Elementary School">Orange Hunt Elementary School</option>
                        <option value="Parkwood Elementary School">Parkwood Elementary School</option>
                        <option value="Pine Spring Elementary School">Pine Spring Elementary School</option>
                        <option value="Pleasant Valley Elementary School">Pleasant Valley Elementary School</option>
                        <option value="Poe Middle School Elementary Program">Poe Elementary Program</option>
                        <option value="Powell Elementary School">Powell Elementary School</option>
                        <option value="Ravensworth Elementary School">Ravensworth Elementary School</option>
                        <option value="Riverside Elementary School">Riverside Elementary School</option>
                        <option value="Rolling Valley Elementary School">Rolling Valley Elementary School</option>
                        <option value="Rose Hill Elementary School">Rose Hill Elementary School</option>
                        <option value="Sangster Elementary School">Sangster Elementary School</option>
                        <option value="Sideburn Run Elementary School">Sideburn Run Elementary School</option>
                        <option value="Sleepy Hollow Elementary School">Sleepy Hollow Elementary School</option>
                        <option value="South County Elementary School">South County Elementary School</option>
                        <option value="Springfield Estates Elementary School">Springfield Estates Elementary School</option>
                        <option value="Stone Bridge Elementary School">Stone Bridge Elementary School</option>
                        <option value="Sunrise Valley Elementary School">Sunrise Valley Elementary School</option>
                        <option value="Terra Centre Elementary School">Terra Centre Elementary School</option>
                        <option value="Timber Lane Elementary School">Timber Lane Elementary School</option>
                        <option value="Union Mill Elementary School">Union Mill Elementary School</option>
                        <option value="Villa Elementary School">Villa Elementary School</option>
                        <option value="Virginia Run Elementary School">Virginia Run Elementary School</option>
                        <option value="Waples Mill Elementary School">Waples Mill Elementary School</option>
                        <option value="West Springfield Elementary School">West Springfield Elementary School</option>
                        <option value="Westfield Elementary School">Westfield Elementary School</option>
                        <option value="White Oaks Elementary School">White Oaks Elementary School</option>
                        <option value="Willow Springs Elementary School">Willow Springs Elementary School</option>
                        <option value="Windsor Elementary School">Windsor Elementary School</option>
                        <option value="Wolf Trap Elementary School">Wolf Trap Elementary School</option>
                        <option value="Woodley Hills Elementary School">Woodley Hills Elementary School</option>
                        <option value="Woodburn Elementary School">Woodburn Elementary School</option>
                    </optgroup>
                    <optgroup label="Middle Schools">
                        <option value="Bowman Middle School">Bowman Middle School</option>
                        <option value="Carson Middle School">Carson Middle School</option>
                        <option value="Chain Bridge Forest Middle School">Chain Bridge Forest Middle School</option>
                        <option value="Chantilly Academy">Chantilly Academy</option>
                        <option value="Cooper Middle School">Cooper Middle School</option>
                        <option value="Daniels Run Elementary School for the Arts and Sciences">Daniels Run ESAS Middle Program</option>
                        <option value="Falls Church High School Middle School Program">Falls Church MS Program</option>
                        <option value="Frost Middle School">Frost Middle School</option>
                        <option value="Franklin Middle School">Franklin Middle School</option>
                        <option value="Glasgow Middle School">Glasgow Middle School</option>
                        <option value="Hayfield Middle School">Hayfield Middle School</option>
                        <option value="Holmes Middle School">Holmes Middle School</option>
                        <option value="Hughes Middle School">Hughes Middle School</option>
                        <option value="Irving Middle School">Irving Middle School</option>
                        <option value="Jackson Middle School">Jackson Middle School</option>
                        <option value="Johnson Middle School">Johnson Middle School</option>
                        <option value="Key Middle School">Key Middle School</option>
                        <option value="Kilmer Middle School">Kilmer Middle School</option>
                        <option value="Lake Braddock Secondary School Middle Program">Lake Braddock MS Program</option>
                        <option value="Lanier Middle School">Lanier Middle School</option>
                        <option value="Longfellow Middle School">Longfellow Middle School</option>
                        <option value="Luther Jackson Middle School">Luther Jackson Middle School</option>
                        <option value="Marshall Road Elementary School Middle Program">Marshall Road MS Program</option>
                        <option value="Poe Middle School">Poe Middle School</option>
                        <option value="Robinson Secondary School Middle Program">Robinson MS Program</option>
                        <option value="Rocky Run Middle School">Rocky Run Middle School</option>
                        <option value="Sandburg Middle School">Sandburg Middle School</option>
                        <option value="Stone Middle School">Stone Middle School</option>
                        <option value="Thoreau Middle School">Thoreau Middle School</option>
                        <option value="Twain Middle School">Twain Middle School</option>
                        <option value="Whitman Middle School">Whitman Middle School</option>
                    </optgroup>
                </select>
                <button class="search-btn" onclick="selectSchool()">View School</button>
            </div>
            <div class="filter-container">
                <button class="filter-btn active" onclick="filterSchools('all')">All Schools</button>
                <button class="filter-btn" onclick="filterSchools('elementary')">Elementary</button>
                <button class="filter-btn" onclick="filterSchools('middle')">Middle School</button>
            </div>
        </div>

        <div id="loadingDiv" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Loading school safety data...</p>
        </div>

        <div id="errorDiv" class="error-message" style="display: none;">
            <p>Unable to load school data. Please check your internet connection and try again.</p>
        </div>

        <div id="schoolsContainer">
            <!-- Schools will be loaded here -->
        </div>
    </div>

    <script>
        // Sample data - In production, this would come from Fairfax County APIs
        const sampleSchools = [
            {
                name: "Annandale Elementary School",
                type: "Elementary",
                address: "4700 Annandale Rd, Annandale, VA 22003",
                score: 87,
                crimeRate: 2.1,
                trafficIncidents: 5,
                sexOffenders: 1,
                nearbyViolentCrime: 0.8
            },
            {
                name: "Bailey's Elementary School",
                type: "Elementary",
                address: "6245 Leesburg Pike, Falls Church, VA 22044",
                score: 83,
                crimeRate: 2.8,
                trafficIncidents: 7,
                sexOffenders: 1,
                nearbyViolentCrime: 1.1
            },
            {
                name: "Braddock Elementary School",
                type: "Elementary", 
                address: "9200 Burke Lake Rd, Burke, VA 22015",
                score: 92,
                crimeRate: 1.4,
                trafficIncidents: 3,
                sexOffenders: 0,
                nearbyViolentCrime: 0.3
            },
            {
                name: "Camelot Elementary School",
                type: "Elementary",
                address: "4705 Annandale Rd, Annandale, VA 22003",
                score: 84,
                crimeRate: 2.6,
                trafficIncidents: 6,
                sexOffenders: 1,
                nearbyViolentCrime: 1.0
            },
            {
                name: "Centreville Elementary School",
                type: "Elementary",
                address: "13619 St Germain Dr, Centreville, VA 20120",
                score: 89,
                crimeRate: 1.8,
                trafficIncidents: 4,
                sexOffenders: 0,
                nearbyViolentCrime: 0.6
            },
            {
                name: "Chantilly Elementary School",
                type: "Elementary",
                address: "4488 Brookfield Corporate Dr, Chantilly, VA 20151",
                score: 86,
                crimeRate: 2.2,
                trafficIncidents: 6,
                sexOffenders: 1,
                nearbyViolentCrime: 0.9
            },
            {
                name: "Carson Middle School",
                type: "Middle School",
                address: "13618 McLearen Rd, Herndon, VA 20171",
                score: 78,
                crimeRate: 3.2,
                trafficIncidents: 8,
                sexOffenders: 2,
                nearbyViolentCrime: 1.2
            },
            {
                name: "Colvin Run Elementary School",
                type: "Elementary",
                address: "10201 Colvin Run Rd, Great Falls, VA 22066",
                score: 95,
                crimeRate: 0.9,
                trafficIncidents: 2,
                sexOffenders: 0,
                nearbyViolentCrime: 0.1
            },
            {
                name: "Daniels Run Elementary School",
                type: "Elementary",
                address: "3705 Old Lee Hwy, Fairfax, VA 22030",
                score: 85,
                crimeRate: 2.3,
                trafficIncidents: 6,
                sexOffenders: 1,
                nearbyViolentCrime: 0.9
            },
            {
                name: "Eagle View Elementary School",
                type: "Elementary",
                address: "13000 Dairymaid Dr, Herndon, VA 20171",
                score: 94,
                crimeRate: 1.1,
                trafficIncidents: 2,
                sexOffenders: 0,
                nearbyViolentCrime: 0.2
            },
            {
                name: "Franklin Middle School",
                type: "Middle School",
                address: "3020 Lees Corner Rd, Chantilly, VA 20151",
                score: 81,
                crimeRate: 2.8,
                trafficIncidents: 7,
                sexOffenders: 1,
                nearbyViolentCrime: 1.0
            },
            {
                name: "Frost Middle School",
                type: "Middle School",
                address: "4101 Pickett Rd, Fairfax, VA 22032",
                score: 84,
                crimeRate: 2.5,
                trafficIncidents: 6,
                sexOffenders: 1,
                nearbyViolentCrime: 0.8
            },
            {
                name: "Great Falls Elementary School",
                type: "Elementary",
                address: "701 Walker Rd, Great Falls, VA 22066",
                score: 96,
                crimeRate: 0.7,
                trafficIncidents: 1,
                sexOffenders: 0,
                nearbyViolentCrime: 0.1
            },
            {
                name: "Herndon Elementary School",
                type: "Elementary",
                address: "660 Dranesville Rd, Herndon, VA 20170",
                score: 82,
                crimeRate: 2.9,
                trafficIncidents: 8,
                sexOffenders: 2,
                nearbyViolentCrime: 1.3
            },
            {
                name: "Hughes Middle School",
                type: "Middle School",
                address: "11301 Gainsborough Rd, Reston, VA 20191",
                score: 88,
                crimeRate: 1.9,
                trafficIncidents: 4,
                sexOffenders: 0,
                nearbyViolentCrime: 0.5
            },
            {
                name: "Irving Middle School",
                type: "Middle School",
                address: "8100 Old Keene Mill Rd, Springfield, VA 22152",
                score: 79,
                crimeRate: 3.1,
                trafficIncidents: 9,
                sexOffenders: 2,
                nearbyViolentCrime: 1.4
            },
            {
                name: "Kings Park Elementary School",
                type: "Elementary",
                address: "8401 Marquis Ln, Springfield, VA 22152",
                score: 80,
                crimeRate: 3.0,
                trafficIncidents: 8,
                sexOffenders: 2,
                nearbyViolentCrime: 1.2
            },
            {
                name: "Lake Anne Elementary School",
                type: "Elementary",
                address: "11510 North Shore Dr, Reston, VA 20190",
                score: 91,
                crimeRate: 1.5,
                trafficIncidents: 3,
                sexOffenders: 0,
                nearbyViolentCrime: 0.4
            },
            {
                name: "Longfellow Middle School",
                type: "Middle School",
                address: "2000 Westmoreland St, Falls Church, VA 22043",
                score: 86,
                crimeRate: 2.4,
                trafficIncidents: 5,
                sexOffenders: 1,
                nearbyViolentCrime: 0.7
            },
            {
                name: "McNair Elementary School",
                type: "Elementary",
                address: "6200 Rolling Rd, Springfield, VA 22152",
                score: 77,
                crimeRate: 3.4,
                trafficIncidents: 10,
                sexOffenders: 3,
                nearbyViolentCrime: 1.6
            },
            {
                name: "Oakton Elementary School",
                type: "Elementary",
                address: "3000 Chain Bridge Rd, Oakton, VA 22124",
                score: 93,
                crimeRate: 1.2,
                trafficIncidents: 2,
                sexOffenders: 0,
                nearbyViolentCrime: 0.3
            },
            {
                name: "Poe Middle School",
                type: "Middle School",
                address: "7000 Cindy Ln, Annandale, VA 22003",
                score: 75,
                crimeRate: 3.6,
                trafficIncidents: 11,
                sexOffenders: 3,
                nearbyViolentCrime: 1.8
            },
            {
                name: "Rocky Run Middle School",
                type: "Middle School",
                address: "4400 Stringfellow Rd, Chantilly, VA 20151",
                score: 87,
                crimeRate: 2.0,
                trafficIncidents: 4,
                sexOffenders: 0,
                nearbyViolentCrime: 0.6
            },
            {
                name: "Sangster Elementary School",
                type: "Elementary",
                address: "7620 Dolce Ln, Springfield, VA 22152",
                score: 74,
                crimeRate: 3.8,
                trafficIncidents: 12,
                sexOffenders: 4,
                nearbyViolentCrime: 2.0
            },
            {
                name: "Stone Middle School",
                type: "Middle School",
                address: "5500 Sully Park Dr, Centreville, VA 20120",
                score: 90,
                crimeRate: 1.6,
                trafficIncidents: 3,
                sexOffenders: 0,
                nearbyViolentCrime: 0.4
            },
            {
                name: "Thoreau Middle School",
                type: "Middle School",
                address: "2505 Cedar Ln, Vienna, VA 22180",
                score: 89,
                crimeRate: 1.7,
                trafficIncidents: 3,
                sexOffenders: 0,
                nearbyViolentCrime: 0.5
            },
            {
                name: "Wolf Trap Elementary School",
                type: "Elementary",
                address: "1205 Beulah Rd, Vienna, VA 22182",
                score: 88,
                crimeRate: 1.9,
                trafficIncidents: 4,
                sexOffenders: 0,
                nearbyViolentCrime: 0.6
            }
        ];

        let currentFilter = 'all';
        let currentSearch = '';

        function getScoreClass(score) {
            if (score >= 90) return 'score-excellent';
            if (score >= 80) return 'score-good';
            if (score >= 70) return 'score-fair';
            return 'score-poor';
        }

        function getScoreLabel(score) {
            if (score >= 90) return 'Excellent';
            if (score >= 80) return 'Good';
            if (score >= 70) return 'Fair';
            return 'Needs Attention';
        }

        function getMetricClass(value, type) {
            if (type === 'crime' || type === 'traffic' || type === 'offenders') {
                if (value <= 2) return 'metric-low';
                if (value <= 5) return 'metric-medium';
                return 'metric-high';
            }
            return 'metric-low';
        }

        function renderSchool(school) {
            return `
                <div class="school-card">
                    <div class="school-header">
                        <div>
                            <div class="school-name">${school.name}</div>
                            <div class="school-type">${school.type}</div>
                            <div class="school-address">${school.address}</div>
                        </div>
                        <div class="safety-score">
                            <div class="score-circle ${getScoreClass(school.score)}">${school.score}</div>
                            <div class="score-label">${getScoreLabel(school.score)}</div>
                        </div>
                    </div>
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-value ${getMetricClass(school.crimeRate, 'crime')}">${school.crimeRate}</div>
                            <div class="metric-label">Crime Rate<br>(per 1000)</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value ${getMetricClass(school.trafficIncidents, 'traffic')}">${school.trafficIncidents}</div>
                            <div class="metric-label">Traffic<br>Incidents</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value ${getMetricClass(school.sexOffenders, 'offenders')}">${school.sexOffenders}</div>
                            <div class="metric-label">Sex Offenders<br>(0.5mi radius)</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value ${getMetricClass(school.nearbyViolentCrime, 'crime')}">${school.nearbyViolentCrime}</div>
                            <div class="metric-label">Violent Crime<br>(per 1000)</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function filterSchools(type) {
            currentFilter = type;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderSchools();
        }

        function selectSchool() {
            const selectedSchool = document.getElementById('schoolSelect').value;
            if (selectedSchool) {
                currentSearch = selectedSchool.toLowerCase();
                renderSchools();
                // Scroll to results
                document.getElementById('schoolsContainer').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function searchSchools() {
            // This function is kept for compatibility but now uses the dropdown
            selectSchool();
        }

        function renderSchools() {
            const container = document.getElementById('schoolsContainer');
            let filteredSchools = sampleSchools;

            // Apply filter
            if (currentFilter !== 'all') {
                filteredSchools = filteredSchools.filter(school => 
                    school.type.toLowerCase().includes(currentFilter)
                );
            }

            // Apply search
            if (currentSearch) {
                filteredSchools = filteredSchools.filter(school =>
                    school.name.toLowerCase().includes(currentSearch) ||
                    school.address.toLowerCase().includes(currentSearch)
                );
            }

            // Sort by safety score (highest first)
            filteredSchools.sort((a, b) => b.score - a.score);

            if (filteredSchools.length === 0) {
                container.innerHTML = `
                    <div class="error-message">
                        <p>No schools found matching your criteria. Try adjusting your search or filter.</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredSchools.map(renderSchool).join('');
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Simulate loading data
            document.getElementById('loadingDiv').style.display = 'block';
            
            setTimeout(() => {
                document.getElementById('loadingDiv').style.display = 'none';
                renderSchools();
            }, 1500);

            // Add change event for dropdown
            document.getElementById('schoolSelect').addEventListener('change', function() {
                if (this.value) {
                    selectSchool();
                }
            });
        });

        // Note: In a production environment, you would replace the sample data with actual API calls:
        // 
        // async function fetchSchoolData() {
        //     try {
        //         // Fairfax County Schools API
        //         const schoolsResponse = await fetch('https://gis.fairfaxcounty.gov/arcgis/rest/services/OpenData/Schools/FeatureServer/0/query?where=1%3D1&outFields=*&outSR=4326&f=json');
        //         const schoolsData = await schoolsResponse.json();
        //         
        //         // Fairfax County Crime Data API
        //         const crimeResponse = await fetch('https://www.fcpod.org/api/search/');
        //         const crimeData = await crimeResponse.json();
        //         
        //         // Virginia Sex Offender Registry API (if available)
        //         // const sexOffenderResponse = await fetch('...');
        //         
        //         // Process and combine the data
        //         return processSchoolSafetyData(schoolsData, crimeData);
        //     } catch (error) {
        //         console.error('Error fetching data:', error);
        //         document.getElementById('errorDiv').style.display = 'block';
        //     }
        // }
    </script>
</body>
</html>
